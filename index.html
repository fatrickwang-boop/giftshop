<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gifted & Co. | Custom Gifts</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            50: '#fdf2f8',
                            100: '#fce7f3',
                            500: '#ec4899', // Pink-500
                            600: '#db2777',
                            900: '#831843',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #d1d5db;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-enter {
            animation: modalIn 0.3s ease-out forwards;
        }

        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans antialiased">

    <!-- Navigation -->
    <nav class="sticky top-0 z-40 bg-white/80 backdrop-blur-md border-b border-gray-100 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex items-center gap-2 cursor-pointer" onclick="window.scrollTo(0,0)">
                    <div class="bg-brand-500 text-white p-2 rounded-lg rotate-3 hover:rotate-0 transition-transform duration-300">
                        <i data-lucide="gift" class="w-6 h-6"></i>
                    </div>
                    <span class="font-bold text-xl tracking-tight text-gray-900">Gifted<span class="text-brand-500">&</span>Co.</span>
                </div>

                <!-- Desktop Nav -->
                <div class="hidden md:flex space-x-8">
                    <a href="#" class="text-gray-500 hover:text-brand-500 transition-colors font-medium">Home</a>
                    <a href="#products" class="text-gray-500 hover:text-brand-500 transition-colors font-medium">Shop</a>
                    <a href="#about" class="text-gray-500 hover:text-brand-500 transition-colors font-medium">How it Works</a>
                </div>

                <!-- Icons -->
                <div class="flex items-center gap-4">
                    <button class="relative p-2 hover:bg-gray-100 rounded-full transition-colors group" onclick="toggleCart()">
                        <i data-lucide="shopping-bag" class="w-6 h-6 text-gray-600 group-hover:text-brand-500"></i>
                        <span id="cart-count" class="absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/4 -translate-y-1/4 bg-brand-500 rounded-full opacity-0 transition-opacity">0</span>
                    </button>
                    <button class="md:hidden p-2 hover:bg-gray-100 rounded-full">
                        <i data-lucide="menu" class="w-6 h-6 text-gray-600"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="relative bg-brand-50 overflow-hidden">
        <div class="absolute inset-0 opacity-10 pattern-dots"></div> <!-- Abstract pattern placeholder -->
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24 relative z-10">
            <div class="grid md:grid-cols-2 gap-12 items-center">
                <div class="space-y-6 text-center md:text-left">
                    <div class="inline-block bg-white px-4 py-1.5 rounded-full text-brand-600 font-semibold text-sm shadow-sm border border-brand-100 mb-2">
                        âœ¨ Uniquely Yours
                    </div>
                    <h1 class="text-4xl md:text-6xl font-bold leading-tight text-gray-900">
                        Gifts as unique as the <span class="text-brand-500">memories</span> you share.
                    </h1>
                    <p class="text-lg text-gray-600 max-w-lg mx-auto md:mx-0">
                        Create personalized treasures for your loved ones. From engraved jewelry to custom prints, we make gifting personal.
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4 justify-center md:justify-start">
                        <a href="#products" class="px-8 py-3.5 bg-brand-500 text-white rounded-full font-semibold shadow-lg shadow-brand-500/30 hover:bg-brand-600 hover:shadow-xl hover:-translate-y-0.5 transition-all">
                            Start Customizing
                        </a>
                        <button class="px-8 py-3.5 bg-white text-gray-700 border border-gray-200 rounded-full font-semibold hover:bg-gray-50 hover:border-gray-300 transition-all">
                            View Collections
                        </button>
                    </div>
                </div>
                <div class="relative">
                    <div class="absolute -inset-4 bg-gradient-to-r from-brand-200 to-purple-200 rounded-full blur-3xl opacity-30 animate-pulse"></div>
                    <img src="https://images.unsplash.com/photo-1513885535751-8b9238bd345a?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80" alt="Gift Wrapping" class="relative rounded-2xl shadow-2xl transform rotate-2 hover:rotate-0 transition-transform duration-500 object-cover h-96 w-full">
                </div>
            </div>
        </div>
    </header>

    <!-- Features Strip -->
    <section class="bg-white border-b border-gray-100 py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
                <div class="flex flex-col items-center text-center gap-2">
                    <div class="bg-blue-50 p-3 rounded-full text-blue-500 mb-1">
                        <i data-lucide="truck" class="w-6 h-6"></i>
                    </div>
                    <h3 class="font-semibold text-sm">Fast Shipping</h3>
                </div>
                <div class="flex flex-col items-center text-center gap-2">
                    <div class="bg-brand-50 p-3 rounded-full text-brand-500 mb-1">
                        <i data-lucide="heart" class="w-6 h-6"></i>
                    </div>
                    <h3 class="font-semibold text-sm">Made with Love</h3>
                </div>
                <div class="flex flex-col items-center text-center gap-2">
                    <div class="bg-green-50 p-3 rounded-full text-green-500 mb-1">
                        <i data-lucide="shield-check" class="w-6 h-6"></i>
                    </div>
                    <h3 class="font-semibold text-sm">Quality Guarantee</h3>
                </div>
                <div class="flex flex-col items-center text-center gap-2">
                    <div class="bg-purple-50 p-3 rounded-full text-purple-500 mb-1">
                        <i data-lucide="pen-tool" class="w-6 h-6"></i>
                    </div>
                    <h3 class="font-semibold text-sm">Free Customization</h3>
                </div>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section id="products" class="py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">Trending Personalizations</h2>
                <p class="text-gray-500">Pick a base product and make it your own.</p>
                
                <!-- Filter Tabs -->
                <div class="flex justify-center gap-2 mt-8 flex-wrap">
                    <button class="px-5 py-2 rounded-full bg-black text-white text-sm font-medium transition-transform active:scale-95">All</button>
                    <button class="px-5 py-2 rounded-full bg-gray-100 text-gray-600 hover:bg-gray-200 text-sm font-medium transition-colors">Apparel</button>
                    <button class="px-5 py-2 rounded-full bg-gray-100 text-gray-600 hover:bg-gray-200 text-sm font-medium transition-colors">Home Decor</button>
                    <button class="px-5 py-2 rounded-full bg-gray-100 text-gray-600 hover:bg-gray-200 text-sm font-medium transition-colors">Accessories</button>
                </div>
            </div>

            <!-- Product Grid -->
            <div id="product-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Products injected by JS -->
            </div>
        </div>
    </section>

    <!-- Product Customization Modal -->
    <div id="product-modal" class="fixed inset-0 z-50 hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <!-- Backdrop -->
        <div class="fixed inset-0 bg-gray-900/60 backdrop-blur-sm transition-opacity" onclick="closeModal()"></div>
        
        <!-- Modal Panel -->
        <div class="fixed inset-0 z-10 overflow-y-auto">
            <div class="flex min-h-full items-center justify-center p-4 text-center sm:p-0">
                <div class="relative transform overflow-hidden rounded-2xl bg-white text-left shadow-2xl transition-all sm:my-8 sm:w-full sm:max-w-4xl modal-enter">
                    
                    <button onclick="closeModal()" class="absolute top-4 right-4 z-10 p-2 bg-white/50 hover:bg-white rounded-full transition-colors">
                        <i data-lucide="x" class="w-6 h-6 text-gray-500"></i>
                    </button>

                    <div class="grid md:grid-cols-2">
                        <!-- Image Side -->
                        <div class="bg-gray-100 h-64 md:h-auto relative group overflow-hidden">
                            <img id="modal-image" src="" alt="Product Detail" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                        </div>

                        <!-- Content Side -->
                        <div class="p-8 flex flex-col h-full">
                            <div class="mb-auto">
                                <span id="modal-category" class="text-xs font-bold tracking-wider text-brand-500 uppercase">Category</span>
                                <h3 id="modal-title" class="text-2xl font-bold text-gray-900 mt-2">Product Name</h3>
                                <p id="modal-price" class="text-xl font-medium text-gray-700 mt-2">$0.00</p>
                                <p id="modal-desc" class="text-gray-500 mt-4 leading-relaxed text-sm">Description goes here.</p>
                            </div>

                            <!-- Customization Form -->
                            <div class="mt-8 space-y-5 border-t border-gray-100 pt-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Custom Text / Name</label>
                                    <input type="text" id="custom-text" placeholder="Enter text here..." class="w-full rounded-lg border-gray-300 border p-3 focus:border-brand-500 focus:ring-brand-500 text-sm transition-colors outline-none" maxlength="20">
                                    <p class="text-xs text-gray-400 mt-1 text-right"><span id="char-count">0</span>/20</p>
                                </div>
                                
                                <div id="color-picker-container" class="hidden">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Select Color</label>
                                    <div class="flex gap-3" id="color-options">
                                        <!-- Color options injected via JS -->
                                    </div>
                                </div>

                                <button onclick="addToCartFromModal()" class="w-full bg-brand-500 text-white py-3.5 rounded-xl font-semibold hover:bg-brand-600 transform active:scale-[0.98] transition-all flex items-center justify-center gap-2 shadow-lg shadow-brand-500/20">
                                    <i data-lucide="shopping-bag" class="w-5 h-5"></i>
                                    Add Custom Gift to Cart
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart Sidebar -->
    <div id="cart-sidebar" class="fixed inset-y-0 right-0 z-50 w-full md:w-96 bg-white shadow-2xl transform translate-x-full transition-transform duration-300 ease-in-out">
        <div class="h-full flex flex-col">
            <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                <h2 class="text-lg font-bold text-gray-900 flex items-center gap-2">
                    <i data-lucide="shopping-cart" class="w-5 h-5"></i> Your Cart
                </h2>
                <button onclick="toggleCart()" class="p-2 hover:bg-gray-200 rounded-full transition-colors">
                    <i data-lucide="x" class="w-5 h-5 text-gray-500"></i>
                </button>
            </div>
            
            <div id="cart-items" class="flex-1 overflow-y-auto p-6 space-y-4">
                <!-- Cart items injected here -->
                <div id="empty-cart-msg" class="flex flex-col items-center justify-center h-full text-center text-gray-400 space-y-4">
                    <i data-lucide="shopping-bag" class="w-12 h-12 opacity-20"></i>
                    <p>Your cart is empty.<br>Let's make something special!</p>
                </div>
            </div>

            <div class="border-t border-gray-100 p-6 bg-gray-50">
                <div class="flex justify-between mb-4 text-gray-600">
                    <span>Subtotal</span>
                    <span id="cart-total" class="font-bold text-gray-900">$0.00</span>
                </div>
                <button onclick="checkout()" class="w-full bg-gray-900 text-white py-3.5 rounded-xl font-semibold hover:bg-gray-800 transition-colors">
                    Checkout Now
                </button>
            </div>
        </div>
    </div>
    
    <!-- Overlay for cart -->
    <div id="cart-overlay" onclick="toggleCart()" class="fixed inset-0 bg-black/20 z-40 hidden backdrop-blur-[1px] transition-opacity"></div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-6 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white px-6 py-3 rounded-full shadow-2xl flex items-center gap-3 translate-y-24 transition-transform duration-300 z-50">
        <i data-lucide="check-circle" class="w-5 h-5 text-green-400"></i>
        <span id="toast-message">Item added to cart</span>
    </div>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-100 pt-16 pb-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-12 mb-12">
                <div class="col-span-1 md:col-span-1">
                     <div class="flex items-center gap-2 mb-4">
                        <div class="bg-brand-500 text-white p-1.5 rounded-md">
                            <i data-lucide="gift" class="w-5 h-5"></i>
                        </div>
                        <span class="font-bold text-lg text-gray-900">Gifted<span class="text-brand-500">&</span>Co.</span>
                    </div>
                    <p class="text-gray-500 text-sm leading-relaxed">
                        Crafting personalized moments since 2024. Every gift tells a story, let us help you write yours.
                    </p>
                </div>
                <div>
                    <h4 class="font-bold text-gray-900 mb-4">Shop</h4>
                    <ul class="space-y-2 text-sm text-gray-500">
                        <li><a href="#" class="hover:text-brand-500 transition-colors">New Arrivals</a></li>
                        <li><a href="#" class="hover:text-brand-500 transition-colors">Best Sellers</a></li>
                        <li><a href="#" class="hover:text-brand-500 transition-colors">Home Decor</a></li>
                        <li><a href="#" class="hover:text-brand-500 transition-colors">Jewelry</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold text-gray-900 mb-4">Support</h4>
                    <ul class="space-y-2 text-sm text-gray-500">
                        <li><a href="#" class="hover:text-brand-500 transition-colors">Order Tracking</a></li>
                        <li><a href="#" class="hover:text-brand-500 transition-colors">Shipping Info</a></li>
                        <li><a href="#" class="hover:text-brand-500 transition-colors">Returns</a></li>
                        <li><a href="#" class="hover:text-brand-500 transition-colors">Contact Us</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold text-gray-900 mb-4">Stay in the loop</h4>
                    <div class="flex gap-2">
                        <input type="email" placeholder="Enter your email" class="bg-gray-50 border border-gray-200 rounded-lg px-4 py-2 text-sm w-full outline-none focus:border-brand-500">
                        <button class="bg-brand-500 text-white px-4 py-2 rounded-lg hover:bg-brand-600 transition-colors">
                            <i data-lucide="arrow-right" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-100 pt-8 flex flex-col md:flex-row justify-between items-center gap-4 text-sm text-gray-400">
                <p>&copy; 2024 Gifted & Co. All rights reserved.</p>
                <div class="flex gap-4">
                    <i data-lucide="instagram" class="w-5 h-5 hover:text-gray-600 cursor-pointer transition-colors"></i>
                    <i data-lucide="facebook" class="w-5 h-5 hover:text-gray-600 cursor-pointer transition-colors"></i>
                    <i data-lucide="twitter" class="w-5 h-5 hover:text-gray-600 cursor-pointer transition-colors"></i>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // --- Data ---
        const products = [
            {
                id: 1,
                name: "Custom Engraved Tumbler",
                category: "Accessories",
                price: 24.99,
                image: "https://images.unsplash.com/photo-1544258327-0402b8d00067?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80",
                desc: "Keep drinks hot or cold with a personal touch. Laser engraved with your name or short phrase.",
                colors: ["#000000", "#FFFFFF", "#FFB6C1", "#87CEEB"]
            },
            {
                id: 2,
                name: "Monogram Canvas Tote",
                category: "Apparel",
                price: 19.50,
                image: "https://images.unsplash.com/photo-1590874103328-eac38a683ce7?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80",
                desc: "Heavy-duty canvas tote perfect for groceries or beach days. Add a large initial or name.",
                colors: ["#F5F5DC", "#2F4F4F"]
            },
            {
                id: 3,
                name: "Personalized Star Map",
                category: "Home Decor",
                price: 39.99,
                image: "https://images.unsplash.com/photo-1519681393784-d120267933ba?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80",
                desc: "Capture the night sky from a special date. Perfect for anniversaries or birthdays.",
                colors: [] // No color options
            },
            {
                id: 4,
                name: "Embroidered Hoodie",
                category: "Apparel",
                price: 45.00,
                image: "https://images.unsplash.com/photo-1556905055-8f358a7a47b2?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80",
                desc: "Soft, cozy hoodie with high-quality embroidery on the chest or sleeve cuff.",
                colors: ["#1F2937", "#9CA3AF", "#818CF8"]
            },
            {
                id: 5,
                name: "Custom Name Necklace",
                category: "Accessories",
                price: 29.99,
                image: "https://images.unsplash.com/photo-1611591437281-460bfbe1220a?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80",
                desc: "Elegant minimalist necklace available in Gold, Silver, or Rose Gold plating.",
                colors: ["#FFD700", "#C0C0C0", "#B76E79"]
            },
            {
                id: 6,
                name: "Photo Memory Pillow",
                category: "Home Decor",
                price: 34.50,
                image: "https://images.unsplash.com/photo-1584100936595-c0654b55a2e6?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80",
                desc: "Turn your favorite photo into a huggable keepsake. High-definition fabric print.",
                colors: []
            }
        ];

        let cart = [];
        let currentProduct = null;
        let selectedColor = null;

        // --- Init ---
        document.addEventListener('DOMContentLoaded', () => {
            renderProducts();
            lucide.createIcons();
            
            // Character count listener
            document.getElementById('custom-text').addEventListener('input', function(e) {
                document.getElementById('char-count').innerText = e.target.value.length;
            });
        });

        // --- Rendering ---
        function renderProducts() {
            const grid = document.getElementById('product-grid');
            grid.innerHTML = products.map(product => `
                <div class="group bg-white rounded-2xl border border-gray-100 overflow-hidden hover:shadow-xl transition-all duration-300 flex flex-col h-full cursor-pointer" onclick="openModal(${product.id})">
                    <div class="relative overflow-hidden h-64">
                        <img src="${product.image}" alt="${product.name}" class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-700">
                        <div class="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors"></div>
                        <button class="absolute bottom-4 right-4 bg-white text-gray-900 p-3 rounded-full shadow-lg opacity-0 translate-y-4 group-hover:opacity-100 group-hover:translate-y-0 transition-all duration-300">
                            <i data-lucide="edit-3" class="w-5 h-5"></i>
                        </button>
                    </div>
                    <div class="p-6 flex-1 flex flex-col">
                        <div class="text-xs font-bold text-brand-500 uppercase tracking-wide mb-1">${product.category}</div>
                        <h3 class="font-bold text-gray-900 text-lg mb-2 group-hover:text-brand-600 transition-colors">${product.name}</h3>
                        <p class="text-gray-500 text-sm mb-4 line-clamp-2 flex-1">${product.desc}</p>
                        <div class="flex justify-between items-center mt-auto">
                            <span class="text-xl font-bold text-gray-900">$${product.price.toFixed(2)}</span>
                            <span class="text-sm font-medium text-brand-500 group-hover:underline">Customize &rarr;</span>
                        </div>
                    </div>
                </div>
            `).join('');
            
            // Re-init icons for new elements
            lucide.createIcons();
        }

        // --- Modal Logic ---
        function openModal(id) {
            currentProduct = products.find(p => p.id === id);
            if (!currentProduct) return;

            document.getElementById('modal-image').src = currentProduct.image;
            document.getElementById('modal-title').innerText = currentProduct.name;
            document.getElementById('modal-category').innerText = currentProduct.category;
            document.getElementById('modal-price').innerText = `$${currentProduct.price.toFixed(2)}`;
            document.getElementById('modal-desc').innerText = currentProduct.desc;
            document.getElementById('custom-text').value = '';
            document.getElementById('char-count').innerText = '0';

            // Handle colors
            const colorContainer = document.getElementById('color-picker-container');
            const colorOptions = document.getElementById('color-options');
            
            if (currentProduct.colors && currentProduct.colors.length > 0) {
                colorContainer.classList.remove('hidden');
                selectedColor = currentProduct.colors[0]; // Default first color
                colorOptions.innerHTML = currentProduct.colors.map((color, index) => `
                    <button onclick="selectColor('${color}', this)" 
                            class="w-8 h-8 rounded-full border-2 ${index === 0 ? 'border-gray-900 scale-110' : 'border-gray-200'} shadow-sm transition-all focus:outline-none"
                            style="background-color: ${color};">
                    </button>
                `).join('');
            } else {
                colorContainer.classList.add('hidden');
                selectedColor = null;
            }

            document.getElementById('product-modal').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('product-modal').classList.add('hidden');
            currentProduct = null;
        }

        function selectColor(color, btnElement) {
            selectedColor = color;
            // Reset borders
            const buttons = document.getElementById('color-options').children;
            for(let btn of buttons) {
                btn.classList.remove('border-gray-900', 'scale-110');
                btn.classList.add('border-gray-200');
            }
            // Set active
            btnElement.classList.remove('border-gray-200');
            btnElement.classList.add('border-gray-900', 'scale-110');
        }

        // --- Cart Logic ---
        function addToCartFromModal() {
            if (!currentProduct) return;

            const customText = document.getElementById('custom-text').value.trim();
            if (customText === "") {
                showToast("Please enter custom text!", "text-red-400");
                return;
            }

            const cartItem = {
                cartId: Date.now(), // Unique ID for cart item
                ...currentProduct,
                customText: customText,
                selectedColor: selectedColor
            };

            cart.push(cartItem);
            updateCartUI();
            closeModal();
            showToast("Added to your cart!");
            
            // Auto open cart
            setTimeout(() => {
                const sidebar = document.getElementById('cart-sidebar');
                if (sidebar.classList.contains('translate-x-full')) {
                    toggleCart();
                }
            }, 300);
        }

        function updateCartUI() {
            // Update count
            const countBadge = document.getElementById('cart-count');
            countBadge.innerText = cart.length;
            if (cart.length > 0) {
                countBadge.classList.remove('opacity-0');
            } else {
                countBadge.classList.add('opacity-0');
            }

            // Render Items
            const itemsContainer = document.getElementById('cart-items');
            if (cart.length === 0) {
                itemsContainer.innerHTML = `
                    <div id="empty-cart-msg" class="flex flex-col items-center justify-center h-full text-center text-gray-400 space-y-4">
                        <i data-lucide="shopping-bag" class="w-12 h-12 opacity-20"></i>
                        <p>Your cart is empty.<br>Let's make something special!</p>
                    </div>
                `;
            } else {
                itemsContainer.innerHTML = cart.map(item => `
                    <div class="flex gap-4 fade-in bg-white p-2 rounded-lg hover:bg-gray-50 transition-colors">
                        <img src="${item.image}" class="w-20 h-20 rounded-lg object-cover bg-gray-100">
                        <div class="flex-1 min-w-0">
                            <h4 class="font-bold text-gray-900 text-sm truncate">${item.name}</h4>
                            <p class="text-xs text-gray-500 mt-1">"${item.customText}"</p>
                            ${item.selectedColor ? `
                                <div class="flex items-center gap-1 mt-1">
                                    <span class="text-xs text-gray-400">Color:</span>
                                    <div class="w-3 h-3 rounded-full border border-gray-200" style="background-color: ${item.selectedColor}"></div>
                                </div>
                            ` : ''}
                            <div class="flex justify-between items-end mt-2">
                                <span class="font-semibold text-sm">$${item.price.toFixed(2)}</span>
                                <button onclick="removeFromCart(${item.cartId})" class="text-xs text-red-500 hover:text-red-700 font-medium p-1 hover:bg-red-50 rounded">Remove</button>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            
            lucide.createIcons();

            // Total
            const total = cart.reduce((sum, item) => sum + item.price, 0);
            document.getElementById('cart-total').innerText = `$${total.toFixed(2)}`;
        }

        function removeFromCart(cartId) {
            cart = cart.filter(item => item.cartId !== cartId);
            updateCartUI();
        }

        function toggleCart() {
            const sidebar = document.getElementById('cart-sidebar');
            const overlay = document.getElementById('cart-overlay');
            
            if (sidebar.classList.contains('translate-x-full')) {
                sidebar.classList.remove('translate-x-full');
                overlay.classList.remove('hidden');
                setTimeout(() => overlay.classList.remove('opacity-0'), 10);
            } else {
                sidebar.classList.add('translate-x-full');
                overlay.classList.add('opacity-0');
                setTimeout(() => overlay.classList.add('hidden'), 300);
            }
        }

        function checkout() {
            if (cart.length === 0) return;
            showToast("Processing Order...", "text-blue-400");
            setTimeout(() => {
                cart = [];
                updateCartUI();
                toggleCart();
                showToast("Order placed successfully!", "text-green-400");
            }, 1500);
        }

        // --- Utilities ---
        function showToast(message, iconClass = "text-green-400") {
            const toast = document.getElementById('toast');
            const msgEl = document.getElementById('toast-message');
            const iconEl = toast.querySelector('i'); // Assumes first icon
            
            msgEl.innerText = message;
            // Reset classes roughly
            iconEl.className = `w-5 h-5 ${iconClass}`;
            lucide.createIcons();

            toast.classList.remove('translate-y-24');
            
            setTimeout(() => {
                toast.classList.add('translate-y-24');
            }, 3000);
        }

    </script>
</body>
</html>